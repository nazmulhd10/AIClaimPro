{% extends 'base.html' %}

{% block title %}AI Chatbot{% endblock %}

{% block content %}
  <h1>AI Chatbot</h1>
  <textarea id="message" rows="4" placeholder="Enter your question here..." class="form-control mb-2"></textarea>
  <button class="btn btn-primary" onclick="askQuestion()">Ask</button>
  <div id="response" class="mt-3 p-3 border rounded bg-light"></div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
      async function askQuestion() {
          const message = document.getElementById("message").value;
          const responseDiv = document.getElementById("response");
          responseDiv.innerHTML = "Loading...";

          const formData = new URLSearchParams();
          formData.append("message", message);

          const response = await fetch("/chat/", {
              method: "POST",
              headers: {
                  "Content-Type": "application/x-www-form-urlencoded",
                  "X-CSRFToken": "{{ csrf_token }}"
              },
              body: formData
          });

          const data = await response.json();
          responseDiv.innerHTML = marked.parse(data.response);
      }
  </script>
{% endblock %}
